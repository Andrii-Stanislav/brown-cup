$(document).ready(function(){var e,t,n,a=[],r=!1,i=$("#header-top").outerHeight();function o(e){$("html, body").animate({scrollTop:$(e).offset().top-i+1},1500)}function s(e,t){var n=$(e);if(n.length){var a=n.children(".franchise-form-slider"),r=a.children(".franchise-form-slider-slide"),i=0,o=r.length,s=n.children(".franchise-form-result"),l=n.children(".franchise-form-btn"),c=l.children(".franchise-form-btn-spinner");n.find('input[type="tel"]').mask("+380(99)999-9999"),n.validate({wrapper:"li",groups:{slide1:"name tel email",slide2:"age city rationale",slide3:"experience marketing investment"},errorClass:"invalid",errorPlacement:function(e,t){s.append(e)},showErrors:function(e,t){this.defaultShowErrors(),this.numberOfInvalids()?s.css("height",s.prop("scrollHeight")):s.css("height",0)}}),$.extend($.validator.messages,{required:"Заполните все поля",email:"Введите действующий e-mail",number:"Введите целое число",max:jQuery.validator.format("Введите число не больше {0}"),min:jQuery.validator.format("Введите число не меньше {0}")}),l.on("click",function(){var e=$(r[i]).children(".franchise-form-input").valid();if(i<o-1)e&&($(r[i]).addClass("previous"),$(r[i+1]).removeClass("next"),a.css("height",$(r[i+1]).prop("scrollHeight")),++i==o-1&&($(this).contents().last()[0].textContent=t));else if(e){l.addClass("disabled"),c.addClass("enabled"),l.contents().last()[0].textContent="";var d=n.serialize();n.find(".franchise-form-input").prop("disabled",!0);var u=!1;return $.ajax({method:"POST",url:"mail.php",data:d}).done(function(e){console.log(e),u="true"==e}).always(function(){s.html("<li>"+(u?"Сообщение отправлено!":"К сожалению, не удалось отправить сообщение :(<br />Попробуйте, пожалуйста, ещё раз")+"</li>").queue(function(e){$(this).css("height",s.prop("scrollHeight")),e()}).delay(3e3).queue(function(e){$(this).css("height",0),u||(n.find(".franchise-form-input").prop("disabled",!1),l.removeClass("disabled")),e()}).queue(function(e){u&&(window.location.href="/thanks")}),c.removeClass("enabled"),l.contents().last()[0].textContent=u?"Отправлено":t}),!1}})}}function l(){r&&($(".header-menu").removeAttr("style"),$(".hamburger").removeClass("is-active"),r=!1)}function c(){var e=$(".instagram-image").outerWidth();$(".instagram-image").css("height",e)}function d(e){for(var t=$(".location-cities li"),n=$(".location-maps iframe"),a=0;a<t.length;a++)t[a].id==e?(t[a].classList.add("active"),n[a].classList.add("active")):(t[a].classList.remove("active"),n[a].classList.remove("active"))}function u(){$("#insta").append('<p class="instagram-error col">К сожалению, при загрузке фото из Instagram возникла ошибка :(</p>')}!function(){var e=$(".feedbacks-carousel");if(!e.length)return;e.flickity({wrapAround:!0,arrowShape:{x0:10,x1:60,y1:50,x2:65,y2:45,x3:20},cellSelector:".feedbacks-item",dragThreshold:10})}(),function(){$(".scrollmagic-pin-spacer").css("min-height",i);var e=new ScrollMagic.Controller({globalSceneOptions:{triggerHook:"onLeave"}});new ScrollMagic.Scene({triggerElement:".header-top"}).setPin(".header-top").setClassToggle(".header-top","active").addTo(e),$("#header").length&&a.push(new ScrollMagic.Scene({triggerElement:"#header",offset:-i,duration:$("#header").outerHeight()}).setClassToggle('a[href^="#header"]',"active").addTo(e));$("#about").length&&a.push(new ScrollMagic.Scene({triggerElement:"#about",offset:-i,duration:$("#about").outerHeight()}).setClassToggle('a[href^="#about"]',"active").addTo(e));$("#digits").length&&a.push(new ScrollMagic.Scene({triggerElement:"#digits",offset:-i,duration:$("#digits").outerHeight()}).setClassToggle('a[href^="#digits"]',"active").addTo(e));$("#advantages").length&&a.push(new ScrollMagic.Scene({triggerElement:"#advantages",offset:-i,duration:$("#advantages").outerHeight()}).setClassToggle('a[href^="#advantages"]',"active").addTo(e));$("#location").length&&a.push(new ScrollMagic.Scene({triggerElement:"#location",offset:-i,duration:$("#location").outerHeight(!0)}).setClassToggle('a[href^="#location"]',"active").addTo(e));$("#franchise").length&&a.push(new ScrollMagic.Scene({triggerElement:"#franchise",offset:-i,duration:$("#franchise").outerHeight()}).setClassToggle('a[href^="#franchise"]',"active").addTo(e));$("#application").length&&a.push(new ScrollMagic.Scene({triggerElement:"#application",offset:-i,duration:$("#application").outerHeight()}).setClassToggle('a[href^="#application"]',"active").addTo(e));$("#formats").length&&a.push(new ScrollMagic.Scene({triggerElement:"#formats",offset:-i,duration:$("#formats").outerHeight()}).setClassToggle('a[href^="#formats"]',"active").addTo(e));$("#included").length&&a.push(new ScrollMagic.Scene({triggerElement:"#included",offset:-i,duration:$("#included").outerHeight()}).setClassToggle('a[href^="#included"]',"active").addTo(e));$("#process").length&&a.push(new ScrollMagic.Scene({triggerElement:"#process",offset:-i,duration:$("#process").outerHeight()}).setClassToggle('a[href^="#process"]',"active").addTo(e));$("#feedbacks").length&&a.push(new ScrollMagic.Scene({triggerElement:"#feedbacks",offset:-i,duration:$("#feedbacks").outerHeight()}).setClassToggle('a[href^="#feedbacks"]',"active").addTo(e))}(),function(){var e=$(".hamburger");if(!e.length)return;e[0].addEventListener("click",function(){r=$(this).hasClass("is-active");var e=$(".header-menu");r?e.removeAttr("style"):e.css("max-height",e.prop("scrollHeight")),r=!r,$(this).toggleClass("is-active")},!1),$(document).on("click","#header-menu a",function(e){l()})}(),function(){if(!$(".counter-number").length)return;var e=new ScrollMagic.Controller({globalSceneOptions:{triggerHook:"onEnter"}}),t=$.animateNumber.numberStepFactories.separator(" "),n=$.animateNumber.numberStepFactories.append("+"),a=Math.floor((Date.now()-1538300359121)/864e5),r=54452+733*a,i=1010341+1963*a;new ScrollMagic.Scene({triggerElement:"#counter-cups"}).addTo(e).on("enter",function(e){$("#counter-cups").animateNumber({number:i,numberStep:t},2e3),$("#counter-clients").animateNumber({number:r,numberStep:t},2e3),$("#counter-institutions").animateNumber({number:21,numberStep:n},2e3),$("#counter-professionals").animateNumber({number:100,numberStep:n},2e3)})}(),$(document).on("click",'a[href^="#"]',function(e){var t=$(this).attr("href");$(t).length>0&&(e.preventDefault(),o(t))}),function(){if(!$("#instagram").length)return;$.ajax({url:"https://api.instagram.com/v1/users/self/media/recent",dataType:"jsonp",type:"GET",data:{access_token:"2964522588.1677ed0.26782c05c460418cb4792c90d3151582",count:9},success:function(e){200!=e.meta.code&&u();for(x in e.data){var t=$('<div class="instagram-image col-4 col-lg-3" style="background-image: url('+e.data[x].images.low_resolution.url+');"><a href="'+e.data[x].link+'" target="_blank"></a></div>');$("#insta").append(t)}c()},error:function(e){u()}})}(),s(".header-middle-form","Получить просчет"),s(".order-form","Получить Чек-лист"),function(){var e=$("#location");if(!e.length)return;for(var t=e.find(".location-cities li"),n=0;n<t.length;n++)$(t[n]).on("click",function(){d(this.id)})}(),function(){var e=$("#formats");if(!e.length)return;var t=function(e){var t=$(e);if(!t.length)return;return t.find(".modal-form-close").on("click",function(){t.hide()}),$(window).on("click",function(e){e.target==t[0]&&t.hide()}),s(".modal-form","Хочу Свою Кофейню"),t}("#modalForm");if(!t)return;e.find(".formats-property-btn").each(function(){$(this).on("click",function(e){$(window).outerWidth()>575?(e.preventDefault(),t.show()):o("#order")})})}(),function(){var e=$("#contact-form");if(!e.length)return;e.find('input[type="tel"]').mask("+380(99)999-9999");var t=e.find(".contact-form-result"),n=e.find(".contact-form-btn"),a=n.children(".contact-form-btn-spinner");e.validate({wrapper:"li",groups:{form:"name tel email message"},errorClass:"invalid",errorPlacement:function(e,n){t.append(e)},showErrors:function(e,n){this.defaultShowErrors(),this.numberOfInvalids()?t.css("height",t.prop("scrollHeight")):t.css("height",0)}}),$.extend($.validator.messages,{required:"Заполните все поля, пожалуйста",email:"Введите действующий e-mail"}),n.on("click",function(){if(e.valid()){n.addClass("disabled"),a.addClass("enabled"),n.contents().last()[0].textContent="";var r=e.serialize();e.find(".contact-input").prop("disabled",!0);var i=!1;return $.ajax({method:"POST",url:"mail.php",data:r}).done(function(e){i="true"==e}).always(function(){t.html("<li>"+(i?"Сообщение отправлено!":"К сожалению, не удалось отправить сообщение :(<br />Попробуйте, пожалуйста, ещё раз")+"</li>").queue(function(e){$(this).css("height",t.prop("scrollHeight")),e()}).delay(3e3).queue(function(t){$(this).css("height",0),i||(e.find(".contact-input").prop("disabled",!1),n.removeClass("disabled")),t()}).queue(function(e){i&&(window.location.href="/thanks")}),a.removeClass("enabled"),n.contents().last()[0].textContent=i?"Отправлено":"Позвоните мне"}),!1}})}(),e=$(window).outerWidth(),t=$(window).outerHeight(),n=!!$("#instagram").length,$(window).on("resize",function(){var r=$(window).outerWidth();r!=e&&(l(),n&&c(),e=r);var i=$(document).height();i!=t&&(function(){for(var e=0;e<a.length;e++){var t=a[e].triggerElement(),n=$(t).outerHeight("location"==t.id);a[e].duration(n)}}(),t=i)}),function(){var e=$("#current-year");if(!e.length)return;e.text((new Date).getFullYear())}()});